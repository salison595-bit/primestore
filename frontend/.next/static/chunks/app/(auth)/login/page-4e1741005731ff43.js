(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{3540:function(e,r,t){Promise.resolve().then(t.bind(t,4965))},4965:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return c}});var a=t(7437),s=t(2265),l=t(9376),o=t(6612),n=t(7648);function c(){let e=(0,l.useRouter)(),{login:r,loading:t,error:c}=(0,o.Z)(),[u,i]=(0,s.useState)({email:"",password:""}),[d,m]=(0,s.useState)(null),h=e=>{let{name:r,value:t}=e.target;i(e=>({...e,[r]:t}))},v=async t=>{if(t.preventDefault(),m(null),!u.email||!u.password){m("Email e senha s\xe3o obrigat\xf3rios");return}let a=await r(u.email,u.password);a.success?e.push("/"):m(a.error)};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black flex items-center justify-center px-4",children:(0,a.jsx)("div",{className:"w-full max-w-md",children:(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 shadow-2xl",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-yellow-400 mb-2 text-center",children:"Prime Store"}),(0,a.jsx)("p",{className:"text-gray-400 text-center mb-8",children:"Fa\xe7a login na sua conta"}),(c||d)&&(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-500 text-red-400 px-4 py-3 rounded mb-6",children:c||d}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:u.email,onChange:h,placeholder:"seu@email.com",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Senha"}),(0,a.jsx)("input",{type:"password",id:"password",name:"password",value:u.password,onChange:h,placeholder:"••••••••",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0})]}),(0,a.jsx)("button",{type:"submit",disabled:t,className:"w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-2 rounded transition disabled:opacity-50",children:t?"Entrando...":"Entrar"})]}),(0,a.jsxs)("div",{className:"mt-6 text-center space-y-4",children:[(0,a.jsx)(n.default,{href:"/forgot-password",className:"text-yellow-400 hover:text-yellow-500 text-sm",children:"Esqueceu sua senha?"}),(0,a.jsxs)("div",{className:"text-gray-400",children:["N\xe3o tem conta?"," ",(0,a.jsx)(n.default,{href:"/register",className:"text-yellow-400 hover:text-yellow-500 font-medium",children:"Registre-se"})]})]})]})})})}},9037:function(e,r,t){"use strict";t.d(r,{Ho:function(){return c}});var a=t(7437),s=t(2265),l=t(3464),o=t(257);let n=(0,s.createContext)();function c(e){let{children:r}=e,[t,c]=(0,s.useState)(null),[u,i]=(0,s.useState)(null),[d,m]=(0,s.useState)(null),[h,v]=(0,s.useState)(!0),[g,p]=(0,s.useState)(null),f=o.env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";(0,s.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("accessToken"),r=localStorage.getItem("user");e&&(i(e),r&&c(JSON.parse(r)))}catch(e){console.error("Erro ao inicializar auth:",e)}finally{v(!1)}})()},[]);let y=(0,s.useCallback)(async(e,r,t,a)=>{try{p(null);let{user:s,accessToken:o,refreshToken:n}=(await l.Z.post("".concat(f,"/auth/register"),{name:e,email:r,password:t,phone:a})).data.data;return c(s),i(o),m(n),localStorage.setItem("user",JSON.stringify(s)),localStorage.setItem("accessToken",o),localStorage.setItem("refreshToken",n),{success:!0,user:s}}catch(r){var s,o,n;let e=(null===(n=r.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:null===(s=o.error)||void 0===s?void 0:s.message)||"Erro ao registrar";return p(e),{success:!1,error:e}}},[f]),x=(0,s.useCallback)(async(e,r)=>{try{p(null);let{user:t,accessToken:a,refreshToken:s}=(await l.Z.post("".concat(f,"/auth/login"),{email:e,password:r})).data.data;return c(t),i(a),m(s),localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("accessToken",a),localStorage.setItem("refreshToken",s),{success:!0,user:t}}catch(r){var t,a,s;let e=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:null===(t=a.error)||void 0===t?void 0:t.message)||"Email ou senha inv\xe1lidos";return p(e),{success:!1,error:e}}},[f]),b=(0,s.useCallback)(()=>{c(null),i(null),m(null),p(null),localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},[]),w=(0,s.useCallback)(async()=>{try{if(!d)return!1;let{accessToken:e}=(await l.Z.post("".concat(f,"/auth/refresh"),{refreshToken:d})).data.data;return i(e),localStorage.setItem("accessToken",e),!0}catch(e){return console.error("Erro ao renovar token:",e),b(),!1}},[d,f,b]),k=(0,s.useCallback)(async(e,r)=>{try{return p(null),await l.Z.post("".concat(f,"/auth/change-password"),{currentPassword:e,newPassword:r},{headers:{Authorization:"Bearer ".concat(u)}}),{success:!0}}catch(r){var t,a,s;let e=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:null===(t=a.error)||void 0===t?void 0:t.message)||"Erro ao alterar senha";return p(e),{success:!1,error:e}}},[u,f]),S=(0,s.useCallback)(async e=>{try{return p(null),await l.Z.post("".concat(f,"/auth/forgot-password"),{email:e}),{success:!0}}catch(s){var r,t,a;let e=(null===(a=s.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:null===(r=t.error)||void 0===r?void 0:r.message)||"Erro ao solicitar reset";return p(e),{success:!1,error:e}}},[f]),N=(0,s.useCallback)(async(e,r)=>{try{return p(null),await l.Z.post("".concat(f,"/auth/reset-password"),{token:e,newPassword:r}),{success:!0}}catch(r){var t,a,s;let e=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:null===(t=a.error)||void 0===t?void 0:t.message)||"Erro ao resetar senha";return p(e),{success:!1,error:e}}},[f]);return(0,a.jsx)(n.Provider,{value:{user:t,accessToken:u,refreshToken:d,loading:h,error:g,isAuthenticated:!!t&&!!u,register:y,login:x,logout:b,changePassword:k,requestPasswordReset:S,resetPassword:N,refreshAccessToken:w},children:r})}r.ZP=n},6612:function(e,r,t){"use strict";var a=t(2265),s=t(9037);r.Z=function(){let e=(0,a.useContext)(s.ZP);if(!e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}}},function(e){e.O(0,[448,464,971,117,744],function(){return e(e.s=3540)}),_N_E=e.O()}]);