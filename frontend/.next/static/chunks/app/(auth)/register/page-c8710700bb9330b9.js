(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{7691:function(e,r,a){Promise.resolve().then(a.bind(a,4322))},4322:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return c}});var s=a(7437),t=a(2265),o=a(9376),l=a(6612),n=a(7648);function c(){let e=(0,o.useRouter)(),{register:r,loading:a,error:c}=(0,l.Z)(),[i,d]=(0,t.useState)({name:"",email:"",password:"",confirmPassword:"",phone:""}),[u,m]=(0,t.useState)(null),[h,p]=(0,t.useState)({level:0,message:""}),g=e=>{let{name:r,value:a}=e.target;d(e=>({...e,[r]:a})),"password"===r&&p(x(a))},x=e=>{let r=0,a="Muito fraca";return e.length>=8&&r++,/[a-z]/.test(e)&&/[A-Z]/.test(e)&&r++,/\d/.test(e)&&r++,/[@$!%*?&]/.test(e)&&r++,a=["Muito fraca","Fraca","M\xe9dia","Forte","Muito forte"][r],{level:r,message:a}},f=async a=>{if(a.preventDefault(),m(null),!i.name||!i.email||!i.password){m("Preencha todos os campos obrigat\xf3rios");return}if(i.password!==i.confirmPassword){m("As senhas n\xe3o correspondem");return}if(h.level<2){m("Escolha uma senha mais forte");return}let s=await r(i.name,i.email,i.password,i.phone);s.success?e.push("/"):m(s.error)},v=["red","orange","yellow","lime","green"][h.level];return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black flex items-center justify-center px-4 py-8",children:(0,s.jsx)("div",{className:"w-full max-w-md",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 shadow-2xl",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-yellow-400 mb-2 text-center",children:"Prime Store"}),(0,s.jsx)("p",{className:"text-gray-400 text-center mb-8",children:"Crie sua conta"}),(c||u)&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-500 text-red-400 px-4 py-3 rounded mb-6",children:c||u}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Nome Completo"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:g,placeholder:"Seu Nome",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",value:i.email,onChange:g,placeholder:"seu@email.com",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefone (Opcional)"}),(0,s.jsx)("input",{type:"tel",id:"phone",name:"phone",value:i.phone,onChange:g,placeholder:"(11) 99999-0000",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Senha"}),(0,s.jsx)("input",{type:"password",id:"password",name:"password",value:i.password,onChange:g,placeholder:"••••••••",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0}),i.password&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("div",{className:"flex gap-1 mb-1",children:[0,1,2,3,4].map(e=>(0,s.jsx)("div",{className:"h-2 flex-1 rounded ".concat(e<h.level?"bg-".concat(v,"-500"):"bg-gray-600")},e))}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["For\xe7a: ",(0,s.jsx)("span",{className:"text-yellow-400",children:h.message})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirmar Senha"}),(0,s.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:i.confirmPassword,onChange:g,placeholder:"••••••••",className:"w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",required:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:a,className:"w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-2 rounded transition disabled:opacity-50 mt-6",children:a?"Criando conta...":"Criar Conta"})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-400",children:["J\xe1 tem conta?"," ",(0,s.jsx)(n.default,{href:"/login",className:"text-yellow-400 hover:text-yellow-500 font-medium",children:"Fa\xe7a login"})]})})]})})})}},9037:function(e,r,a){"use strict";a.d(r,{Ho:function(){return c}});var s=a(7437),t=a(2265),o=a(3464),l=a(257);let n=(0,t.createContext)();function c(e){let{children:r}=e,[a,c]=(0,t.useState)(null),[i,d]=(0,t.useState)(null),[u,m]=(0,t.useState)(null),[h,p]=(0,t.useState)(!0),[g,x]=(0,t.useState)(null),f=l.env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";(0,t.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("accessToken"),r=localStorage.getItem("user");e&&(d(e),r&&c(JSON.parse(r)))}catch(e){console.error("Erro ao inicializar auth:",e)}finally{p(!1)}})()},[]);let v=(0,t.useCallback)(async(e,r,a,s)=>{try{x(null);let{user:t,accessToken:l,refreshToken:n}=(await o.Z.post("".concat(f,"/auth/register"),{name:e,email:r,password:a,phone:s})).data.data;return c(t),d(l),m(n),localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("accessToken",l),localStorage.setItem("refreshToken",n),{success:!0,user:t}}catch(r){var t,l,n;let e=(null===(n=r.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:null===(t=l.error)||void 0===t?void 0:t.message)||"Erro ao registrar";return x(e),{success:!1,error:e}}},[f]),y=(0,t.useCallback)(async(e,r)=>{try{x(null);let{user:a,accessToken:s,refreshToken:t}=(await o.Z.post("".concat(f,"/auth/login"),{email:e,password:r})).data.data;return c(a),d(s),m(t),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",t),{success:!0,user:a}}catch(r){var a,s,t;let e=(null===(t=r.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:null===(a=s.error)||void 0===a?void 0:a.message)||"Email ou senha inv\xe1lidos";return x(e),{success:!1,error:e}}},[f]),b=(0,t.useCallback)(()=>{c(null),d(null),m(null),x(null),localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},[]),w=(0,t.useCallback)(async()=>{try{if(!u)return!1;let{accessToken:e}=(await o.Z.post("".concat(f,"/auth/refresh"),{refreshToken:u})).data.data;return d(e),localStorage.setItem("accessToken",e),!0}catch(e){return console.error("Erro ao renovar token:",e),b(),!1}},[u,f,b]),N=(0,t.useCallback)(async(e,r)=>{try{return x(null),await o.Z.post("".concat(f,"/auth/change-password"),{currentPassword:e,newPassword:r},{headers:{Authorization:"Bearer ".concat(i)}}),{success:!0}}catch(r){var a,s,t;let e=(null===(t=r.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:null===(a=s.error)||void 0===a?void 0:a.message)||"Erro ao alterar senha";return x(e),{success:!1,error:e}}},[i,f]),j=(0,t.useCallback)(async e=>{try{return x(null),await o.Z.post("".concat(f,"/auth/forgot-password"),{email:e}),{success:!0}}catch(t){var r,a,s;let e=(null===(s=t.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:null===(r=a.error)||void 0===r?void 0:r.message)||"Erro ao solicitar reset";return x(e),{success:!1,error:e}}},[f]),k=(0,t.useCallback)(async(e,r)=>{try{return x(null),await o.Z.post("".concat(f,"/auth/reset-password"),{token:e,newPassword:r}),{success:!0}}catch(r){var a,s,t;let e=(null===(t=r.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:null===(a=s.error)||void 0===a?void 0:a.message)||"Erro ao resetar senha";return x(e),{success:!1,error:e}}},[f]);return(0,s.jsx)(n.Provider,{value:{user:a,accessToken:i,refreshToken:u,loading:h,error:g,isAuthenticated:!!a&&!!i,register:v,login:y,logout:b,changePassword:N,requestPasswordReset:j,resetPassword:k,refreshAccessToken:w},children:r})}r.ZP=n},6612:function(e,r,a){"use strict";var s=a(2265),t=a(9037);r.Z=function(){let e=(0,s.useContext)(t.ZP);if(!e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}}},function(e){e.O(0,[448,464,971,117,744],function(){return e(e.s=7691)}),_N_E=e.O()}]);