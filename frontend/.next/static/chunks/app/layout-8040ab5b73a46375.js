(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2303:function(e,t,r){Promise.resolve().then(r.bind(r,2504)),Promise.resolve().then(r.t.bind(r,2126,23)),Promise.resolve().then(r.t.bind(r,7960,23))},7960:function(){},2126:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3",variable:"__variable_f367f3"}},2504:function(e,t,r){"use strict";r.d(t,{CombinedProviders:function(){return s}});var a=r(7437),l=r(9037),o=r(5559);function s(e){let{children:t}=e;return(0,a.jsx)(l.Ho,{children:(0,a.jsx)(o.Zl,{children:t})})}},9037:function(e,t,r){"use strict";r.d(t,{Ho:function(){return c}});var a=r(7437),l=r(2265),o=r(3464),s=r(257);let n=(0,l.createContext)();function c(e){let{children:t}=e,[r,c]=(0,l.useState)(null),[u,i]=(0,l.useState)(null),[d,v]=(0,l.useState)(null),[f,h]=(0,l.useState)(!0),[m,g]=(0,l.useState)(null),k=s.env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";(0,l.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("accessToken"),t=localStorage.getItem("user");e&&(i(e),t&&c(JSON.parse(t)))}catch(e){console.error("Erro ao inicializar auth:",e)}finally{h(!1)}})()},[]);let p=(0,l.useCallback)(async(e,t,r,a)=>{try{g(null);let{user:l,accessToken:s,refreshToken:n}=(await o.Z.post("".concat(k,"/auth/register"),{name:e,email:t,password:r,phone:a})).data.data;return c(l),i(s),v(n),localStorage.setItem("user",JSON.stringify(l)),localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",n),{success:!0,user:l}}catch(t){var l,s,n;let e=(null===(n=t.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:null===(l=s.error)||void 0===l?void 0:l.message)||"Erro ao registrar";return g(e),{success:!1,error:e}}},[k]),S=(0,l.useCallback)(async(e,t)=>{try{g(null);let{user:r,accessToken:a,refreshToken:l}=(await o.Z.post("".concat(k,"/auth/login"),{email:e,password:t})).data.data;return c(r),i(a),v(l),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("accessToken",a),localStorage.setItem("refreshToken",l),{success:!0,user:r}}catch(t){var r,a,l;let e=(null===(l=t.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:null===(r=a.error)||void 0===r?void 0:r.message)||"Email ou senha inv\xe1lidos";return g(e),{success:!1,error:e}}},[k]),y=(0,l.useCallback)(()=>{c(null),i(null),v(null),g(null),localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},[]),b=(0,l.useCallback)(async()=>{try{if(!d)return!1;let{accessToken:e}=(await o.Z.post("".concat(k,"/auth/refresh"),{refreshToken:d})).data.data;return i(e),localStorage.setItem("accessToken",e),!0}catch(e){return console.error("Erro ao renovar token:",e),y(),!1}},[d,k,y]),_=(0,l.useCallback)(async(e,t)=>{try{return g(null),await o.Z.post("".concat(k,"/auth/change-password"),{currentPassword:e,newPassword:t},{headers:{Authorization:"Bearer ".concat(u)}}),{success:!0}}catch(t){var r,a,l;let e=(null===(l=t.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:null===(r=a.error)||void 0===r?void 0:r.message)||"Erro ao alterar senha";return g(e),{success:!1,error:e}}},[u,k]),C=(0,l.useCallback)(async e=>{try{return g(null),await o.Z.post("".concat(k,"/auth/forgot-password"),{email:e}),{success:!0}}catch(l){var t,r,a;let e=(null===(a=l.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:null===(t=r.error)||void 0===t?void 0:t.message)||"Erro ao solicitar reset";return g(e),{success:!1,error:e}}},[k]),E=(0,l.useCallback)(async(e,t)=>{try{return g(null),await o.Z.post("".concat(k,"/auth/reset-password"),{token:e,newPassword:t}),{success:!0}}catch(t){var r,a,l;let e=(null===(l=t.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:null===(r=a.error)||void 0===r?void 0:r.message)||"Erro ao resetar senha";return g(e),{success:!1,error:e}}},[k]);return(0,a.jsx)(n.Provider,{value:{user:r,accessToken:u,refreshToken:d,loading:f,error:m,isAuthenticated:!!r&&!!u,register:p,login:S,logout:y,changePassword:_,requestPasswordReset:C,resetPassword:E,refreshAccessToken:b},children:t})}t.ZP=n},5559:function(e,t,r){"use strict";r.d(t,{Zl:function(){return s}});var a=r(7437),l=r(2265);let o=(0,l.createContext)();function s(e){let{children:t}=e,[r,s]=(0,l.useState)([]),[n,c]=(0,l.useState)(null),[u,i]=(0,l.useState)(0),[d,v]=(0,l.useState)(.1);(0,l.useEffect)(()=>{try{let e=localStorage.getItem("cart");e&&s(JSON.parse(e))}catch(e){console.error("Erro ao carregar carrinho:",e)}},[]),(0,l.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r))},[r]);let f=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s(r=>{var a,l;return r.find(t=>t.id===e.id)?r.map(r=>r.id===e.id?{...r,quantity:r.quantity+t}:r):[...r,{id:e.id,name:e.name,price:e.price,image:(null===(l=e.images)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.imageUrl)||"/placeholder.jpg",quantity:t,product:e}]})},[]),h=(0,l.useCallback)(e=>{s(t=>t.filter(t=>t.id!==e))},[]),m=(0,l.useCallback)((e,t)=>{if(t<=0){h(e);return}s(r=>r.map(r=>r.id===e?{...r,quantity:t}:r))},[h]),g=(0,l.useCallback)(()=>{s([]),c(null)},[]),k=(0,l.useCallback)(e=>{c(e)},[]),p=(0,l.useCallback)(()=>{c(null)},[]),S=r.reduce((e,t)=>e+t.price*t.quantity,0),y=n?"PERCENTAGE"===n.type?n.value/100*S:n.value:0,b=(S-y)*d,_={items:r,coupon:n,shippingCost:u,taxRate:d,subtotal:S,discountAmount:y,tax:b,total:S-y+b+u,itemCount:r.reduce((e,t)=>e+t.quantity,0),addItem:f,removeItem:h,updateQuantity:m,clearCart:g,applyCoupon:k,removeCoupon:p,setShippingCost:i,setTaxRate:v};return(0,a.jsx)(o.Provider,{value:_,children:t})}t.ZP=o}},function(e){e.O(0,[447,464,971,117,744],function(){return e(e.s=2303)}),_N_E=e.O()}]);